{% extends "staff_portal/base.html" %}
{% load static %}

{% block title %}{% if is_create %}Add{% else %}Edit{% endif %} Staff Member{% endblock %}

{% block extra_head %}
{{ form.media }}
<style>
    .ck-editor__editable {
        min-height: 300px;
    }
</style>
{% endblock %}

{% block content %}
<div class="mb-8">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">
                {% if is_create %}Add New Staff Member{% else %}Edit Staff Member{% endif %}
            </h1>
            <p class="mt-2 text-gray-600">
                {% if is_create %}
                    Add a new staff member or leadership to your organization
                {% else %}
                    Editing: {{ staff_member.full_name }}
                {% endif %}
            </p>
        </div>
        <a href="{% url 'staff_portal:staff_member_list' %}" class="inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-semibold rounded-lg transition">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to List
        </a>
    </div>
</div>

<form method="post" enctype="multipart/form-data" class="space-y-6">
    {% csrf_token %}

    {% if form.non_field_errors %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
        {{ form.non_field_errors }}
    </div>
    {% endif %}

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Main Content Column -->
        <div class="lg:col-span-2 space-y-6">
            <!-- Basic Information -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Basic Information</h2>

                <!-- Full Name -->
                <div class="mb-4">
                    <label for="{{ form.full_name.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Full Name <span class="text-red-500">*</span>
                    </label>
                    {{ form.full_name }}
                    {% if form.full_name.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.full_name.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Position -->
                <div class="mb-4">
                    <label for="{{ form.position.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Position/Job Title <span class="text-red-500">*</span>
                    </label>
                    {{ form.position }}
                    {% if form.position.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.position.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Department and Position Type -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="{{ form.department.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            Department
                        </label>
                        {{ form.department }}
                        {% if form.department.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.department.errors.0 }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.position_type.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            Position Type <span class="text-red-500">*</span>
                        </label>
                        {{ form.position_type }}
                        {% if form.position_type.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.position_type.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Bio -->
                <div class="mb-4">
                    <label for="{{ form.bio.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Professional Biography
                    </label>
                    {{ form.bio }}
                    <p class="mt-1 text-sm text-gray-500">Professional background and accomplishments</p>
                    {% if form.bio.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.bio.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>

            <!-- Contact Information -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Contact Information</h2>

                <!-- Email and Phone -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            Email Address
                        </label>
                        {{ form.email }}
                        {% if form.email.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.email.errors.0 }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            Phone Number
                        </label>
                        {{ form.phone }}
                        {% if form.phone.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.phone.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>

                <!-- Social Media Links -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="{{ form.linkedin_url.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            LinkedIn URL
                        </label>
                        {{ form.linkedin_url }}
                        {% if form.linkedin_url.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.linkedin_url.errors.0 }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.twitter_url.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                            Twitter URL
                        </label>
                        {{ form.twitter_url }}
                        {% if form.twitter_url.errors %}
                            <p class="mt-1 text-sm text-red-600">{{ form.twitter_url.errors.0 }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar Column -->
        <div class="space-y-6">
            <!-- Photo -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Profile Photo</h2>

                {% if not is_create and staff_member.photo %}
                <div class="mb-4">
                    <img src="{{ staff_member.photo.url }}" alt="{{ staff_member.full_name }}" class="w-full h-auto rounded-lg">
                    <p class="mt-2 text-sm text-gray-500">Current photo</p>
                </div>
                {% endif %}

                <div class="mb-4">
                    <label for="{{ form.photo.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        {% if is_create %}Upload Photo <span class="text-red-500">*</span>{% else %}Change Photo{% endif %}
                    </label>
                    {{ form.photo }}
                    <p class="mt-1 text-sm text-gray-500">Recommended: 400x400px, square format</p>
                    {% if form.photo.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.photo.errors.0 }}</p>
                    {% endif %}
                </div>
            </div>

            <!-- Display Settings -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Display Settings</h2>

                <!-- Display Order -->
                <div class="mb-4">
                    <label for="{{ form.display_order.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Display Order
                    </label>
                    {{ form.display_order }}
                    <p class="mt-1 text-sm text-gray-500">Lower numbers appear first</p>
                    {% if form.display_order.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.display_order.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Joined Date -->
                <div class="mb-4">
                    <label for="{{ form.joined_date.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                        Date Joined
                    </label>
                    {{ form.joined_date }}
                    {% if form.joined_date.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ form.joined_date.errors.0 }}</p>
                    {% endif %}
                </div>

                <!-- Active Status -->
                <div class="flex items-center">
                    <div class="flex items-center h-5">
                        {{ form.is_active }}
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="{{ form.is_active.id_for_label }}" class="font-medium text-gray-700">
                            Active
                        </label>
                        <p class="text-gray-500">Show this staff member on the public website</p>
                    </div>
                </div>
                {% if form.is_active.errors %}
                    <p class="mt-1 text-sm text-red-600">{{ form.is_active.errors.0 }}</p>
                {% endif %}
            </div>

            <!-- Action Buttons -->
            <div class="bg-white rounded-lg shadow p-6">
                <button type="submit" class="w-full px-6 py-3 bg-amma-gold hover:bg-amma-gold-dark text-white font-semibold rounded-lg transition shadow-sm">
                    {% if is_create %}Add Staff Member{% else %}Update Staff Member{% endif %}
                </button>
                <a href="{% url 'staff_portal:staff_member_list' %}" class="mt-3 w-full inline-block text-center px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition">
                    Cancel
                </a>
            </div>
        </div>
    </div>
</form>
{% endblock %}
